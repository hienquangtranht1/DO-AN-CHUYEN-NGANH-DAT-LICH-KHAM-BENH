@* File: Views/Home/Doctors.cshtml *@
@model IEnumerable<BookinhMVC.Models.BacSi>
@{
    ViewData["Title"] = "Danh sách bác sĩ";
    Layout = "~/Views/Shared/_Layout.cshtml"; // Giữ lại layout chung
    var departments = ViewBag.Departments as List<BookinhMVC.Models.Khoa>;
    string searchName = ViewBag.SearchName as string ?? "";
    int selectedDepartment = ViewBag.SelectedDepartment != null ? (int)ViewBag.SelectedDepartment : 0;
}

@* HEADER & BREADCRUMB (Đồng bộ với các trang dịch vụ) *@
<section class="blog-header fade-in" data-aos="fade-down" style="
    background-image: url('/images/background.png');
    background-size: cover;
    background-position: center;
    position: relative;
    min-height: 250px;
    display: flex;
    flex-direction: column;
    border-radius: 0 0 1.5rem 1.5rem;
    overflow: hidden;
">
    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; "></div>
    <div class="container position-relative z-2 flex-grow-1 d-flex align-items-center justify-content-center text-center pt-5">
        <div>
            <h1 class="display-4 fw-bold text-dark mb-2">
                <i class="fas fa-users-medical me-3"></i>Đội ngũ Bác sĩ
            </h1>
            <p class="lead text-dark-50">Tìm kiếm và lựa chọn bác sĩ phù hợp với nhu cầu của bạn</p>
        </div>
    </div>

    <div class="breadcrumb-section position-absolute bottom-0 w-100 py-3 z-3">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0 justify-content-center">
                    <li class="breadcrumb-item"><a href="/" class="text-dark text-decoration-none"><i class="fas fa-home me-1"></i>Trang chủ</a></li>
                    <li class="breadcrumb-item active text-dark" aria-current="page"><i class="fas fa-user-md me-1"></i>Bác sĩ</li>
                </ol>
            </nav>
        </div>
    </div>
</section>

<div class="container my-5">

    @* FORM TÌM KIẾM *@
    <form method="get" asp-action="Doctors" asp-controller="Home" class="row g-3 mb-5 justify-content-center" data-aos="fade-up">
        <div class="col-md-4">
            <input type="text" name="name" value="@searchName" class="form-control rounded-pill py-3"
                   placeholder="Nhập tên bác sĩ..." />
        </div>
        <div class="col-md-4">
            <select name="departmentId" class="form-select rounded-pill py-3">
                <option value="0">Tất cả khoa</option>
                @if (departments != null)
                {
                    foreach (var d in departments)
                    {
                        <option value="@d.MaKhoa" selected="@(selectedDepartment == d.MaKhoa ? "selected" : null)">@d.TenKhoa</option>
                    }
                }
            </select>
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100 rounded-pill py-3 fw-bold">
                <i class="fas fa-search"></i> Tìm kiếm
            </button>
        </div>
    </form>

    @* DANH SÁCH BÁC SĨ *@
    <div class="row g-4 justify-content-center">
        @if (Model != null && Model.Any())
        {
            foreach (var doctor in Model)
            {
                <div class="col-12 col-sm-6 col-md-4 col-lg-3" data-aos="fade-up">
                    <div class="doctor-card card h-100 shadow-sm text-center p-4">
                        <img src="@(string.IsNullOrEmpty(doctor.HinhAnhBacSi) ? Url.Content("~/images/doctors/default.jpg") : Url.Content("~/uploads/" + doctor.HinhAnhBacSi))"
                             class="doctor-img mx-auto mb-3"
                             alt="@doctor.HoTen" />
                        <div class="card-body p-0 d-flex flex-column">
                            <h5 class="doctor-name card-title mb-1">@doctor.HoTen</h5>
                            @* Dùng class badge đồng bộ *@
                            <span class="badge bg-info text-dark mb-3 doctor-dept">@doctor.Khoa?.TenKhoa</span>
                            <a href="@Url.Action("Book", "Appointment", new { selectedDoctorId = doctor.MaBacSi })"
                               class="btn btn-outline-primary btn-sm w-100 mt-auto rounded-pill fw-bold">
                                <i class="fas fa-calendar-alt me-1"></i> Đặt lịch
                            </a>
                        </div>
                    </div>
                </div>
            }
        }
    </div>
</div>

<style>
    /* Đồng bộ hóa các biến màu từ _Layout.cshtml hoặc trang Blog */
    :root {
        --primary-color: #0d6efd; /* Blue */
        --secondary-color: #6c757d; /* Gray */
        --accent-color: #0dcaf0; /* Cyan/Light Blue */
        --text-color: #212529;
    }

    /* === Header/Breadcrumb Styling === */
    .blog-header {
        position: relative;
        min-height: 250px !important;
    }

    /* === Card & Components Styling === */
    .doctor-card {
        border-radius: 1.5rem; /* Tăng bo tròn */
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); /* Shadow nhẹ */
        transition: transform 0.3s, box-shadow 0.3s;
        background: #fff;
        height: 100%;
        border: none;
    }

        .doctor-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(13, 110, 253, 0.2); /* Shadow xanh khi hover */
        }

    .doctor-img {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border-radius: 50%;
        /* Sử dụng màu đồng bộ */
        border: 5px solid #e0f2fe;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 1rem !important;
    }

    .doctor-name {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--primary-color);
    }

    .doctor-dept {
        background: var(--bg-accent); /* Màu nền badge nhạt */
        color: var(--primary-color) !important;
        font-size: 0.9em;
        border-radius: 0.5rem;
        padding: 0.4em 1em;
        font-weight: 600;
    }

    .btn-outline-primary {
        /* Màu button đồng bộ */
        color: var(--primary-color);
        border-color: var(--primary-color);
        border-width: 2px;
        padding: 0.5rem 1.25rem;
        font-weight: 600;
        transition: all 0.2s;
    }

        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: #fff;
        }

    /* Responsive adjustments */
    @@media (max-width: 767px) {
        .doctor-img {
            width: 90px;
            height: 90px;
        }

        .doctor-name {
            font-size: 1.1rem;
        }
    }
</style>

@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script>
        AOS.init({
            duration: 800,
            once: true,
            offset: 50
        });
    </script>
}