@using BookinhMVC.Models
@using Microsoft.AspNetCore.Http
@using System.Collections.Generic
@* KHAI BÁO MODEL VÀ VIEW BAG *@
@{
    ViewData["Title"] = "Four Rock - Chăm sóc sức khỏe hàng đầu";
    // Lấy dữ liệu từ ViewBag
    var doctors = ViewBag.Doctors as List<BacSi>;
    var reviews = ViewBag.Reviews as List<DanhGia>;
    var latestArticles = ViewBag.Articles as List<Article>; // Dữ liệu Blog đã lấy từ HomeController
    Layout = "~/Views/Shared/_Layout.cshtml";
    var patientName = Context.Session.GetString("PatientName");
    var userRole = Context.Session.GetString("UserRole");
    // Tính toán điểm đánh giá trung bình cho mỗi bác sĩ (giữ nguyên logic hiện có)
    var doctorRatings = new Dictionary<int, double>();
    if (reviews != null)
    {
        doctorRatings = reviews
          .GroupBy(r => r.MaBacSi)
          .ToDictionary(
          g => g.Key,
          g => g.Average(r => (double)r.DiemDanhGia)
          );
    }
    var featuredDoctors = doctors?
      .Where(d =>
      {
          if (doctorRatings.ContainsKey(d.MaBacSi))
          {
              return doctorRatings[d.MaBacSi] >= 4.0;
          }
          return true;
      })
      .ToList();
}
<section id="hero" class="hero-section position-relative overflow-hidden">
    <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="5000">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <div class="hero-overlay position-relative">
                    <img src="~/images/slide1.png" class="d-block w-100 hero-img" alt="Slide 1" style="height: 85vh; object-fit: cover;" />
                    <div class="carousel-caption d-none d-md-block">
                        <div class="container h-100 d-flex align-items-center justify-content-center text-center">
                            <div class="hero-content animate__animated animate__fadeInUp">
                                <h1 class="display-4 fw-bold text-white mb-4 lh-1">Chăm sóc sức khỏe<br />toàn diện</h1>
                                <p class="lead fs-5 text-white-50 mb-5">Tiên phong trong đổi mới dịch vụ y tế với công nghệ hiện đại</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="hero-overlay position-relative">
                    <img src="~/images/slide2.png" class="d-block w-100 hero-img" alt="Slide 2" style="height: 85vh; object-fit: cover;" />
                    <div class="carousel-caption d-none d-md-block">
                        <div class="container h-100 d-flex align-items-center justify-content-center text-center">
                            <div class="hero-content animate__animated animate__fadeInUp">
                                <h1 class="display-4 fw-bold text-white mb-4 lh-1">Công nghệ<br />hiện đại</h1>
                                <p class="lead fs-5 text-white-50 mb-5">Ứng dụng thiết bị y tế tiên tiến và trí tuệ nhân tạo</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="hero-overlay position-relative">
                    <img src="~/images/slide3.png" class="d-block w-100 hero-img" alt="Slide 3" style="height: 85vh; object-fit: cover;" />
                    <div class="carousel-caption d-none d-md-block">
                        <div class="container h-100 d-flex align-items-center justify-content-center text-center">
                            <div class="hero-content animate__animated animate__fadeInUp">
                                <h1 class="display-4 fw-bold text-white mb-4 lh-1">Đội ngũ bác sĩ<br />chuyên nghiệp</h1>
                                <p class="lead fs-5 text-white-50 mb-5">Luôn sẵn sàng chăm sóc sức khỏe của bạn 24/7</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <div class="hero-mobile-caption d-md-none position-absolute bottom-0 start-50 translate-middle-x pb-4">
        <div class="text-center text-white px-3">
            <h2 class="h4 fw-bold mb-2">Chăm sóc sức khỏe toàn diện</h2>
            <p class="mb-3 small">Tiên phong trong đổi mới dịch vụ y tế</p>
            <a href="@Url.Action("Book", "Appointment")" class="btn btn-primary btn-lg px-4">Đặt lịch ngay</a>
        </div>
    </div>
</section>
<section id="reasons-to-choose" class="py-4 bg-gradient-light">
    <div class="container">
        <div class="text-center mb-4" data-aos="fade-up">
            <h2 class="display-5 fw-bold mb-3">Vì sao lựa chọn <span class="text-primary">Four Rock</span>?</h2>
            <p class="lead text-muted">Chúng tôi cam kết mang lại trải nghiệm chăm sóc sức khỏe tốt nhất cho bạn.</p>
        </div>
        <div class="row g-3 g-md-4">
            <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="100">
                <div class="card h-100 border-0 shadow-sm rounded-4 text-center p-3 p-md-4 bg-white transition-all">
                    <i class="fas fa-cogs fa-3x text-primary mb-3 mx-auto"></i>
                    <h5 class="fw-bold mb-2">Cơ sở vật chất - Trang thiết bị hiện đại</h5>
                    <p class="card-text small text-muted flex-grow-1">Bệnh viện đầu tư hệ thống trang thiết bị đồng bộ, công nghệ hiện đại được tài trợ lên đến hàng triệu USD nhằm phục vụ tốt nhất các dịch vụ khám chữa bệnh.</p>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="200">
                <div class="card h-100 border-0 shadow-sm rounded-4 text-center p-3 p-md-4 bg-white transition-all">
                    <i class="fas fa-hands-helping fa-3x text-primary mb-3 mx-auto"></i>
                    <h5 class="fw-bold mb-2">Dịch vụ chuyên nghiệp - Quy trình tiêu chuẩn</h5>
                    <p class="card-text small text-muted flex-grow-1">Bệnh viện quy tụ đội ngũ chuyên gia có trình độ chuyên môn, tận tâm. Dịch vụ khám, tư vấn và chữa bệnh toàn diện, chất lượng; không gian văn minh, lịch sự, đảm bảo kiểm soát nhiễm khuẩn.</p>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="300">
                <div class="card h-100 border-0 shadow-sm rounded-4 text-center p-3 p-md-4 bg-white transition-all">
                    <i class="fas fa-vial fa-3x text-primary mb-3 mx-auto"></i>
                    <h5 class="fw-bold mb-2">Hoạt động trên nền tảng y học thực chứng</h5>
                    <p class="card-text small text-muted flex-grow-1">Bệnh viện có định hướng xuyên suốt là triển khai y học dựa trên bằng chứng dựa trên nền tảng Trường đại học nghiên cứu hàng đầu về Y tế công cộng tại Việt Nam.</p>
                </div>
            </div>
            <div class="col-12 col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="400">
                <div class="card h-100 border-0 shadow-sm rounded-4 text-center p-3 p-md-4 bg-white transition-all">
                    <i class="fas fa-sync-alt fa-3x text-primary mb-3 mx-auto"></i>
                    <h5 class="fw-bold mb-2">Liên tục cải tiến chất lượng</h5>
                    <p class="card-text small text-muted flex-grow-1">Luôn đặt khách hàng làm trung tâm, lấy an toàn người bệnh làm giá trị cốt lõi, bệnh viện cam kết đem đến dịch vụ chăm sóc sức khỏe tốt nhất cho khách hàng, không ngừng cải tiến chất lượng nhằm tiến tới đạt tiêu chuẩn của Bộ Y tế.</p>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="services" class="py-4 bg-gradient-light">
    <div class="container">
        <div class="text-center mb-4" data-aos="fade-up">
            <h2 class="display-5 fw-bold mb-3">Dịch vụ nổi bật</h2>
            <p class="lead text-muted">Cung cấp các dịch vụ y tế chất lượng cao với công nghệ hiện đại</p>
        </div>
        <div class="row g-3 g-md-4">
            <div class="col-12 col-md-4" data-aos="fade-up" data-aos-delay="100">
                <div class="card h-100 border-0 shadow-lg service-box rounded-4 overflow-hidden transition-all">
                    <div class="position-relative">
                        <img src="~/images/service1.png" class="card-img-top service-img" alt="Khám tổng quát" style="height: 200px; object-fit: cover;" />
                        <div class="position-absolute bottom-0 start-0 end-0 bg-primary bg-opacity-90 text-white p-2 p-md-3">
                            <h5 class="mb-0 fw-bold small">Khám tổng quát</h5>
                        </div>
                    </div>
                    <div class="card-body p-3 p-md-4">
                        <p class="card-text small">Khám sức khỏe ban đầu, phát hiện sớm các bệnh lý tiềm ẩn với đội ngũ bác sĩ chuyên nghiệp.</p>
                        <a asp-action="GeneralCheckup" asp-controller="Home" class="btn btn-primary rounded-pill mt-2 small">
                            <i class="fas fa-arrow-right me-1"></i>Xem chi tiết
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-4" data-aos="fade-up" data-aos-delay="200">
                <div class="card h-100 border-0 shadow-lg service-box rounded-4 overflow-hidden transition-all">
                    <div class="position-relative">
                        <img src="~/images/service2.png" class="card-img-top service-img" alt="Tim mạch" style="height: 200px; object-fit: cover;" />
                        <div class="position-absolute bottom-0 start-0 end-0 bg-primary bg-opacity-90 text-white p-2 p-md-3">
                            <h5 class="mb-0 fw-bold small">Tim mạch</h5>
                        </div>
                    </div>
                    <div class="card-body p-3 p-md-4">
                        <p class="card-text small">Giám sát và điều trị bệnh về tim mạch với chuyên gia hàng đầu cùng thiết bị hiện đại.</p>
                        <a asp-action="Cardiology" asp-controller="Home" class="btn btn-primary rounded-pill mt-2 small">
                            <i class="fas fa-arrow-right me-1"></i>Xem chi tiết
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-4" data-aos="fade-up" data-aos-delay="300">
                <div class="card h-100 border-0 shadow-lg service-box rounded-4 overflow-hidden transition-all">
                    <div class="position-relative">
                        <img src="~/images/service3.png" class="card-img-top service-img" alt="Xét nghiệm" style="height: 200px; object-fit: cover;" />
                        <div class="position-absolute bottom-0 start-0 end-0 bg-primary bg-opacity-90 text-white p-2 p-md-3">
                            <h5 class="mb-0 fw-bold small">Xét nghiệm</h5>
                        </div>
                    </div>
                    <div class="card-body p-3 p-md-4">
                        <p class="card-text small">Cung cấp các dịch vụ xét nghiệm hiện đại với độ chính xác cao và kết quả nhanh chóng.</p>
                        <a asp-action="Testing" asp-controller="Home" class="btn btn-primary rounded-pill mt-2 small">
                            <i class="fas fa-arrow-right me-1"></i>Xem chi tiết
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="doctors" class="py-4" style="background-color: #f0f8ff; position: relative;border-radius:20px; overflow: hidden;">
    <style>

        /* Định nghĩa style cho Doctors Section */
        #doctors {
            background-image: url('../images/background.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
        }

            #doctors .container {
                position: relative;
                z-index: 1;
            }

        .rating-stars {
            color: #ffc107; /* Màu vàng của sao */
        }


        /* Thêm style cho horizontal slider */
        .doctors-slider {
            overflow: hidden;
            position: relative;
        }


        /* Cấu trúc hiển thị 4 item trên một hàng (desktop) */
        .doctors-carousel-item {
            display: flex; /* Dùng flexbox để đặt các card con ngang hàng */
            flex-wrap: nowrap; /* Ngăn không cho các card con xuống dòng */
            transition: transform 0.5s ease-in-out;
        }

        .doctor-card-wrapper {
            flex: 0 0 25%; /* 4 items ngang hàng trên desktop: 100%/4 = 25% */
            max-width: 25%;
            padding: 0 10px; /* Khoảng cách giữa các card */
            box-sizing: border-box;
        }

        .doctor-card {
            display: flex;
            flex-direction: column;
        }

        .doctor-card-content {
            flex: 1;
        }

        .doctor-card-button {
            margin-top: auto;
        }


        /* Ẩn carousel controls trên mobile và tablet khi chỉ có 1 hoặc 2 bác sĩ */
        .doctors-slider .carousel-control-prev,
        .doctors-slider .carousel-control-next {
            width: 5%;
            opacity: 0.5;
        }


        /* Media Query cho Tablet (<= 768px) */
        @@media (max-width: 992px) { /* Chuyển thành 2 item trên màn hình vừa */
            .doctor-card-wrapper {
                flex: 0 0 50%; /* 2 items trên tablet: 100%/2 = 50% */
                max-width: 50%;
            }
        }


        /* Media Query cho Mobile (<= 576px) */
        @@media (max-width: 576px) {
            .doctor-card-wrapper {
                flex: 0 0 100%; /* 1 item trên mobile */
                max-width: 100%;
            }

            .doctors-slider .carousel-control-prev,
            .doctors-slider .carousel-control-next {
                display: none; /* Ẩn nút điều khiển trên mobile */
            }
        }

        .doctors-slider .carousel-control-prev:hover,
        .doctors-slider .carousel-control-next:hover {
            opacity: 1;
        }

    </style>
    <div class="container">
        <div class="text-center mb-4" data-aos="fade-up">
            <h2 class="display-5 fw-bold mb-2 d-flex align-items-center justify-content-center">
                <i class="fas fa-user-md text-primary me-2"></i>Bác sĩ nổi bật
            </h2>
            <p class="lead text-muted">Đội ngũ bác sĩ chuyên khoa giàu kinh nghiệm, tận tâm với sức khỏe của bạn</p>
        </div>
        @if (featuredDoctors != null && featuredDoctors.Count > 0)
        {
            <div id="doctorsCarousel" class="carousel slide doctors-slider" data-bs-ride="carousel" data-bs-interval="4000">
                <div class="carousel-inner">
                    @{
                        const int doctorsPerSlide = 4; // Số bác sĩ hiển thị trên 1 slide cho desktop (sẽ tự động điều chỉnh bằng CSS/JS)
                                                       // Chia danh sách bác sĩ thành các nhóm (slide)
                        for (int i = 0; i < featuredDoctors.Count; i += doctorsPerSlide)
                        {
                            <div class="carousel-item @(i == 0 ? "active" : "")">
                                <div class="doctors-carousel-item justify-content-center">
                                    @foreach (var doctor in featuredDoctors.Skip(i).Take(doctorsPerSlide))
                                    {
                                        // Lấy điểm trung bình hoặc 0 nếu không có đánh giá
                                        double avgRating = doctorRatings.ContainsKey(doctor.MaBacSi) ? doctorRatings[doctor.MaBacSi] : 0.0;
                                        int fullStars = (int)Math.Floor(avgRating);
                                        bool hasHalfStar = (avgRating - fullStars) >= 0.5;
                                        int emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);

                                        <div class="doctor-card-wrapper" data-aos="zoom-in" data-aos-delay="@((featuredDoctors.IndexOf(doctor) % doctorsPerSlide) * 100)">
                                            <a href="@Url.Action("Book", "Appointment", new { selectedDoctorId = doctor.MaBacSi })" class="text-decoration-none">
                                                <div class="doctor-card position-relative rounded-4 shadow-sm p-3 p-md-4 h-100 transition-all bg-white text-center" style="border: none;">
                                                    <div class="doctor-card-content">
                                                        <div class="position-relative mb-3">
                                                            <img src="@(string.IsNullOrEmpty(doctor.HinhAnhBacSi) ? Url.Content("~/images/doctors/default.jpg") : Url.Content("~/uploads/" + doctor.HinhAnhBacSi))"
                                                                 class="rounded-circle doctor-image mx-auto shadow-lg"
                                                                 style="width:140px; height:140px; object-fit:cover; "
                                                                 alt="@doctor.HoTen" />
                                                        </div>
                                                        <h6 class="fw-bold text-dark mb-1 small text-center">@doctor.HoTen</h6>
                                                        <p class="text-muted small mb-1 text-center">@doctor.Khoa?.TenKhoa</p>
                                                        @* Hiển thị sao đánh giá *@
                                                        <div class="mb-3 rating-stars small text-center">
                                                            @for (int j = 0; j < fullStars; j++)
                                                            {
                                                                <i class="fas fa-star"></i>
                                                            }
                                                            @if (hasHalfStar)
                                                            {
                                                                <i class="fas fa-star-half-alt"></i>
                                                            }
                                                            @for (int j = 0; j < emptyStars; j++)
                                                            {
                                                                <i class="far fa-star text-muted"></i>
                                                            }
                                                            <span class="text-muted small">@avgRating.ToString("F1")</span>
                                                        </div>
                                                    </div>
                                                    <button class="btn btn-primary rounded-pill w-100 py-2 small doctor-card-button">
                                                        <i class="fas fa-calendar-check me-2"></i>Đặt lịch
                                                    </button>
                                                </div>
                                            </a>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    }
                </div>

                @* Chỉ hiển thị nút điều khiển nếu tổng số bác sĩ nổi bật lớn hơn 4 *@
                @if (featuredDoctors.Count > doctorsPerSlide)
                {
                    <button class="carousel-control-prev" type="button" data-bs-target="#doctorsCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#doctorsCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                }
            </div>

            @* Nút xem thêm bác sĩ (nếu tổng số bác sĩ có đánh giá >=4 hoặc chưa có đánh giá > 4) *@
            @if (doctors != null && doctors.Count > 4)
            {
                <div class="col-12 text-center mt-3">
                    <a href="@Url.Action("Doctors", "Home")" class="btn btn-outline-primary rounded-pill px-4 py-2">
                        <i class="fas fa-plus me-2"></i>Xem thêm bác sĩ
                    </a>
                </div>
            }
        }
        else
        {
            <div class="col-12 text-center" data-aos="fade-up">
                <i class="fas fa-user-md fa-3x mb-3 text-muted"></i>
                <p class="lead">Hiện chưa có bác sĩ nào đạt tiêu chí nổi bật (đánh giá trung bình từ 4 sao trở lên hoặc chưa có đánh giá).</p>
            </div>
        }
    </div>
</section>
<section id="about" class="py-4 bg-white">
    <div class="container">
        <div class="row align-items-center g-4" data-aos="fade-up">
            <div class="col-12 col-lg-6">
                <h2 class="display-6 fw-bold mb-3">Giới thiệu về <span class="text-primary">Four Rock</span></h2>
                <p class="lead mb-3 text-muted">Four Rock tự hào là địa chỉ chăm sóc sức khỏe hàng đầu với cơ sở vật chất hiện đại, đội ngũ bác sĩ chuyên nghiệp và dịch vụ y tế toàn diện. Chúng tôi cam kết mang lại sự an tâm và hài lòng cho bệnh nhân thông qua chất lượng dịch vụ và ứng dụng công nghệ tiên tiến.</p>
                <div class="row g-3 mb-4">
                    <div class="col-6 col-md-3">
                        <div class="text-center p-2 rounded-3 bg-light transition-all">
                            <i class="fas fa-award fa-2x text-primary mb-2"></i>
                            <div class="fw-bold fs-4">15+</div>
                            <div class="text-muted small">Năm kinh nghiệm</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="text-center p-2 rounded-3 bg-light transition-all">
                            <i class="fas fa-user-doctor fa-2x text-primary mb-2"></i>
                            <div class="fw-bold fs-4">50+</div>
                            <div class="text-muted small">Bác sĩ chuyên khoa</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="text-center p-2 rounded-3 bg-light transition-all">
                            <i class="fas fa-users fa-2x text-primary mb-2"></i>
                            <div class="fw-bold fs-4">10,000+</div>
                            <div class="text-muted small">Bệnh nhân tin tưởng</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="text-center p-2 rounded-3 bg-light transition-all">
                            <i class="fas fa-star fa-2x text-primary mb-2"></i>
                            <div class="fw-bold fs-4">4.9/5</div>
                            <div class="text-muted small">Đánh giá khách hàng</div>
                        </div>
                    </div>
                </div>
                <a asp-action="HospitalAbout" asp-controller="Home" class="btn btn-primary btn-lg px-3 px-md-4 rounded-pill shadow-sm">
                    <i class="fas fa-info-circle me-2"></i>Xem chi tiết
                </a>
            </div>
            <div class="col-12 col-lg-6 text-center">
                <img src="~/images/hospital.png" alt="Four Rock Hospital" class="img-fluid rounded-4 shadow-lg" style="width:100%; height: auto; max-height: 300px; object-fit: cover;" />
            </div>
        </div>
    </div>
</section>
@* ========================================================================= *@
@* BỔ SUNG PHẦN BLOG LẤY DỮ LIỆU ĐỘNG TỪ CSDL *@
@* ========================================================================= *@
<section id="blog-posts" class="py-4 bg-light">
    <div class="container">
        <div class="text-center mb-4" data-aos="fade-up">
            <h2 class="display-5 fw-bold mb-3"><i class="fas fa-newspaper text-primary me-2"></i>Tin Tức & Blog Y Tế</h2>
            <p class="lead text-muted">Cập nhật những kiến thức và tin tức y tế mới nhất từ chuyên gia của chúng tôi</p>
        </div>
        <div class="row g-3 g-md-4">
            @if (latestArticles != null && latestArticles.Any())
            {
                @foreach (var article in latestArticles)
                {
                    <div class="col-12 col-md-4" data-aos="fade-@(latestArticles.IndexOf(article) == 0 ? "right" : (latestArticles.IndexOf(article) == 1 ? "up" : "left"))">
                        <div class="card h-100 border-0 shadow-lg news-card rounded-4 overflow-hidden transition-all">
                            <img src="@(string.IsNullOrEmpty(article.FeatureImageUrl) ? Url.Content("~/images/default-blog.png") : Url.Content(article.FeatureImageUrl))"
                                 class="card-img-top" alt="@article.Title" style="height: 160px; object-fit: cover;" />
                            <div class="card-body d-flex flex-column p-3 p-md-4 h-100">
                                <span class="badge bg-info mb-2 small">@article.Category.CategoryName</span>
                                <h6 class="card-title fw-bold mb-2 mb-md-3">@article.Title</h6>
                                <p class="card-text text-muted flex-grow-1 mb-2 mb-md-3 small">@article.Summary</p>
                                <div class="d-flex justify-content-between align-items-center mt-auto">
                                    <small class="text-muted"><i class="fas fa-calendar me-1"></i>@article.PublishDate.ToString("dd/MM/yyyy")</small>
                                    <a asp-action="ArticleDetail" asp-route-slug="@article.Slug" class="btn btn-outline-primary btn-sm rounded-pill small">
                                        <i class="fas fa-arrow-right me-1"></i>Đọc tiếp
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="col-12 text-center text-muted p-4">
                    <i class="fas fa-book-medical fa-3x mb-3"></i>
                    <p>Hiện chưa có bài viết nào được xuất bản.</p>
                </div>
            }
        </div>
        @* Nút xem tất cả blog *@
        <div class="text-center mt-4">
            <a asp-action="HospitalBlog" asp-controller="Home" class="btn btn-primary rounded-pill px-4 py-2">
                <i class="fas fa-list-alt me-2"></i>Xem Tất Cả Blog
            </a>
        </div>
    </div>
</section>
@* ========================================================================= *@
<hr class="my-4 d-none d-md-block">
<section id="reviews" class="py-4 bg-white">
    <div class="container">
        <div class="text-center mb-4" data-aos="fade-up">
            <h2 class="display-5 fw-bold mb-3"><i class="fas fa-comment-dots text-primary me-2"></i>Phản hồi từ khách hàng</h2>
            <p class="lead text-muted">Những đánh giá chân thành về chất lượng dịch vụ của chúng tôi.</p>
        </div>
        @if (reviews != null && reviews.Count > 0)
        {
            <div class="row justify-content-center g-3 g-md-4">
                @foreach (var review in reviews.Take(3))
                {
                    <div class="col-12 col-md-4" data-aos="fade-up" data-aos-delay="100">
                        <div class="card h-100 border-0 shadow-lg p-3 rounded-4 transition-all" style="border-left: 5px solid var(--primary-color) !important;">
                            <div class="card-body d-flex flex-column">
                                <div class="text-warning mb-2">
                                    @* Hiển thị số ngôi sao *@
                                    @for (int j = 0; j < review.DiemDanhGia; j++)
                                    {
                                        <i class="fas fa-star"></i>
                                    }
                                    @for (int j = 0; j < 5 - review.DiemDanhGia; j++)
                                    {
                                        <i class="far fa-star text-muted"></i>
                                    }
                                </div>
                                <p class="card-text mb-3 small flex-grow-1">
                                    @* Hiển thị nội dung HTML từ TinyMCE *@
                                    @(string.IsNullOrEmpty(review.NhanXet) ? "Không có nhận xét." : Html.Raw(review.NhanXet))
                                </p>
                                <div class="d-flex align-items-center border-top pt-3 mt-auto">
                                    <i class="fas fa-user-circle fa-2x text-primary me-3"></i>
                                    <div>
                                        <h6 class="mb-0 fw-bold small">@review.BenhNhan?.HoTen</h6>
                                        <p class="text-muted small mb-0">Đánh giá cho Bác sĩ: @review.BacSi?.HoTen</p>
                                    </div>
                                </div>
                                <small class="text-end text-muted mt-2" style="font-size: 0.75rem;">@review.NgayDanhGia.ToString("dd/MM/yyyy")</small>
                            </div>
                        </div>
                    </div>
                }
            </div>
            <div class="text-center mt-5">
                <a asp-action="Reviews" asp-controller="Home" class="btn btn-outline-primary rounded-pill px-4 py-2">
                    <i class="fas fa-comments me-2"></i>Xem tất cả đánh giá
                </a>
            </div>
        }
        else
        {
            <div class="text-center text-muted p-5">
                <i class="fas fa-comment-dots fa-3x mb-3"></i>
                <p>Chưa có đánh giá nào được ghi nhận.</p>
            </div>
        }
    </div>
</section>
<section id="contact" class="py-4 bg-white">
    <div class="container">
        <div class="text-center mb-4" data-aos="fade-up">
            <h2 class="display-5 fw-bold mb-3">Liên hệ với chúng tôi</h2>
            <p class="lead text-muted">Luôn sẵn sàng hỗ trợ và tư vấn cho bạn mọi lúc</p>
        </div>
        <div class="row g-3 mb-4">
            <div class="col-12 col-md-4" data-aos="zoom-in">
                <div class="contact-info p-3 p-md-4 text-center rounded-4 shadow-sm bg-light h-100 d-flex flex-column justify-content-center transition-all">
                    <a href="https://www.google.com/maps" target="_blank" class="text-decoration-none">
                        <i class="fas fa-map-marker-alt fa-2x text-primary mb-2 mb-md-3 d-block"></i>
                        <h5 class="fw-bold mb-1 mb-md-2 small">Địa chỉ</h5>
                        <p class="text-muted small mb-0">Khu E Hutech, Quận 9<br />TP. Hồ Chí Minh</p>
                    </a>
                </div>
            </div>
            <div class="col-12 col-md-4" data-aos="zoom-in" data-aos-delay="100">
                <div class="contact-info p-3 p-md-4 text-center rounded-4 shadow-sm bg-light h-100 d-flex flex-column justify-content-center transition-all">
                    <i class="fas fa-phone fa-2x text-primary mb-2 mb-md-3 d-block"></i>
                    <h5 class="fw-bold mb-1 mb-md-2 small">Hotline</h5>
                    <p class="text-muted small mb-0">(0123) 456-789<br />Hỗ trợ 24/7</p>
                </div>
            </div>
            <div class="col-12 col-md-4" data-aos="zoom-in" data-aos-delay="200">
                <div class="contact-info p-3 p-md-4 text-center rounded-4 shadow-sm bg-light h-100 d-flex flex-column justify-content-center transition-all">
                    <i class="fas fa-envelope fa-2x text-primary mb-2 mb-md-3 d-block"></i>
                    <h5 class="fw-bold mb-1 mb-md-2 small">Email</h5>
                    <p class="text-muted small mb-0">info@fourrock.com<br />support@fourrock.com</p>
                </div>
            </div>
        </div>
        <div class="row g-3">
            <div class="col-12 col-lg-8" data-aos="fade-right">
                <div class="map-responsive rounded-4 overflow-hidden shadow-lg">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3959.2353806617543!2d106.78303187508985!3d10.855738189297968!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3175276e7ea103df%3A0xb6cf10bb7d719327!2zSFVURUNIIC0gxJDhuqFpIGjhu41jIEPDtG5nIG5naOG7hyBUUC5IQ00gKFRodSBEdWMgQ2FtcHVzKQ!5e1!3m2!1svi!2s!4v1749117069821!5m2!1svi!2s"
                            style="border:0; width:100%; height:300px;" allowfullscreen="" loading="lazy"></iframe>
                </div>
            </div>
            <div class="col-12 col-lg-4" data-aos="fade-left">
                <div class="card border-0 shadow-lg rounded-4 h-100">
                    <div class="card-header bg-primary text-white rounded-top-4">
                        <h5 class="mb-0 fw-bold small"><i class="fas fa-paper-plane me-2"></i>Gửi tin nhắn</h5>
                    </div>
                    <div class="card-body p-3 p-md-4">
                        <form>
                            <div class="mb-2 mb-md-3">
                                <input type="text" class="form-control rounded-3 border-primary small" placeholder="Họ và tên" required />
                            </div>
                            <div class="mb-2 mb-md-3">
                                <input type="email" class="form-control rounded-3 border-primary small" placeholder="Email" required />
                            </div>
                            <div class="mb-2 mb-md-3">
                                <input type="tel" class="form-control rounded-3 border-primary small" placeholder="Số điện thoại" required />
                            </div>
                            <div class="mb-3">
                                <textarea class="form-control rounded-3 border-primary small" rows="3" placeholder="Nội dung tin nhắn" required></textarea>
                            </div>
                            <a asp-action="Contact" asp-controller="Home" class="btn btn-primary w-100 rounded-3 small">
                                <i class="fas fa-send me-2"></i>Gửi tin nhắn
                            </a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<style>
    :root {
        --primary-color: #0d6efd;
        --secondary-color: #6c757d;
        --success-color: #198754;
        --warning-color: #ffc107;
        --light-bg: #f8f9fa;
    }

    body {
        font-family: 'Inter', sans-serif;
        line-height: 1.5;
    }

    section {
        border-radius: 20px;
        margin-top: 10px;
    }

    .hero-section {
        height: 85vh;
        border-radius: 20px;
    }

    .hero-overlay::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: transparent;
        z-index: 1;
    }

    .hero-img {
        filter: brightness(1);
    }

    .hero-content {
        max-width: 800px;
    }

    .doctor-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
    }

    .service-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.1) !important;
    }

    .news-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.1) !important;
    }

    .contact-info:hover {
        background: var(--primary-color);
        color: white !important;
        transform: scale(1.05);
    }

        .contact-info:hover i,
        .contact-info:hover h5,
        .contact-info:hover p {
            color: white !important;
        }

    .transition-all {
        transition: all 0.3s ease-in-out;
    }

    .bg-gradient-light {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    }

    .carousel-control-prev-icon,
    .carousel-control-next-icon {
        background-image: none !important;
        background-color: var(--primary-color) !important;
        border-radius: 50%;
        width: 50px !important;
        height: 50px !important;
        display: flex;
        align-items: center;
        justify-content: center;
    }

        .carousel-control-prev-icon::before {
            content: '\2039';
            color: #fff;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .carousel-control-next-icon::before {
            content: '\203A';
            color: #fff;
            font-size: 1.5rem;
            font-weight: bold;
        }

    .map-responsive {
        position: relative;
        padding-bottom: 56.25%; /* 16:9 */
        height: 0;
        overflow: hidden;
    }

        .map-responsive iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100% !important;
            height: 100% !important;
        }

    @@media (max-width: 768px) {
        .hero-section {
            height: 60vh;
        }

        .display-4, .display-5 {
            font-size: 2rem;
        }

        .display-6 {
            font-size: 1.75rem;
        }

        .doctor-image {
            width: 100px !important;
            height: 100px !important;
        }

        .carousel-control-prev, .carousel-control-next {
            width: 20%;
        }

        .service-img {
            height: 180px !important;
        }

        .news-card .card-img-top {
            height: 140px !important;
        }

        .card-body {
            padding: 1rem !important;
        }

        .btn {
            font-size: 0.875rem !important;
            padding: 0.5rem 1rem !important;
        }
    }

    @@media (max-width: 576px) {
        .hero-mobile-caption {
            padding-bottom: 2rem !important;
        }

            .hero-mobile-caption .btn {
                font-size: 0.875rem !important;
                padding: 0.5rem 1rem !important;
            }

        .row.g-3 > * {
            padding-left: 0.5rem !important;
            padding-right: 0.5rem !important;
        }
    }
</style>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
    AOS.init({
        duration: 800,
        once: true,
        offset: 50
    });
    // Initialize carousels
    document.addEventListener('DOMContentLoaded', function () {
        var heroCarousel = new bootstrap.Carousel(document.querySelector('#heroCarousel'), {
            interval: 5000,
            wrap: true
        });
        // Khởi tạo carousel cho doctors với auto-slide
        var doctorsCarousel = new bootstrap.Carousel(document.querySelector('#doctorsCarousel'), {
            interval: 4000, // Tự động trượt mỗi 4 giây
            wrap: true,
            ride: 'carousel' // Bật auto-slide
        });
    });
</script>